<beans:beans xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns="http://www.springframework.org/schema/security"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">
				
	<!-- <context:component-scan base-package="de.dariah.samlsp.orm.dao"/>
	<context:component-scan base-package="de.dariah.samlsp.orm.service" /> -->		
	
	<http security="none" pattern="/resources/**"/>
		
	<http disable-url-rewriting="true" auto-config="true" use-expressions="false" entry-point-ref="ajaxEntryPoint" access-decision-manager-ref="accessDecisionManager" >
		<csrf disabled="true"/>
		<intercept-url pattern="/test/jumboFluid" requires-channel="http" access="IS_AUTHENTICATED_FULLY" />
		<form-login 
			authentication-success-handler-ref="simpleUrlAuthenticationSuccessHandler"
			login-page="/login" 
			authentication-failure-url="/login?error"
			username-parameter="username"
			password-parameter="password"
			/>
		<logout invalidate-session="true" logout-url="/logout" logout-success-url="/" />
	</http>
	
	<beans:bean id="simpleUrlAuthenticationSuccessHandler" class="org.springframework.security.web.authentication.SimpleUrlAuthenticationSuccessHandler">
		<beans:property name="defaultTargetUrl" value="/"/>
		<beans:property name="targetUrlParameter" value="redirectUrl"/>
	</beans:bean>
		
	<global-method-security pre-post-annotations="enabled" secured-annotations="enabled" />
	
  	<beans:bean id="ajaxEntryPoint" class="org.springframework.security.web.authentication.Http403ForbiddenEntryPoint">
	</beans:bean>
	
	<beans:bean id="authInfoHelper" class="eu.dariah.de.dariahsp.web.AuthInfoHelper" />
	
	<authentication-manager alias="authenticationManager">
	  <authentication-provider ref="localAuthenticationProvider" />
	</authentication-manager>
	
	<beans:bean id="localAuthenticationProvider" class="eu.dariah.de.dariahsp.web.LocalAuthenticationProvider">
		<beans:property name="localUserDb" ref="localUserDb" />
		<beans:property name="userService">
			<beans:bean class="eu.dariah.de.minfba.schereg.service.UserServiceImpl" />
		</beans:property>
	</beans:bean>

	<user-service id="localUserDb">
		<user name="tgradl" password="hairad" authorities="ROLE_ADMINISTRATOR, ROLE_CONTRIBUTOR" />
		<user name="tgradl_user" password="hairad" authorities="" />
		<user name="ahenrich" password="hairad" authorities="ROLE_CONTRIBUTOR" />
		
		<user name="teckart" password="niralc" authorities="ROLE_CONTRIBUTOR" />
		
		<user name="nutzer_hab" password="augusT66" authorities="ROLE_CONTRIBUTOR" />
        <user name="nutzer_ksw" password="goEthe49" authorities="ROLE_CONTRIBUTOR" />
		
		<!-- 
		<user name="workshop1" password="dariah411" authorities="" />
		<user name="workshop2" password="dariah532" authorities="" />
		<user name="workshop3" password="dariah141" authorities="" />
		<user name="workshop4" password="dariah152" authorities="" />
		<user name="workshop5" password="dariah715" authorities="" />
		<user name="workshop6" password="dariah251" authorities="" />
		<user name="workshop7" password="dariah433" authorities="" />
		<user name="workshop8" password="dariah562" authorities="" />
		<user name="workshop9" password="dariah797" authorities="" />
		<user name="workshop10" password="dariah632" authorities="" />
		<user name="workshop11" password="dariah422" authorities="" />
		<user name="workshop12" password="dariah737" authorities="" />
		<user name="workshop13" password="dariah244" authorities="" />
		<user name="workshop14" password="dariah235" authorities="" />
		<user name="workshop15" password="dariah728" authorities="" />
		<user name="workshop16" password="dariah442" authorities="" />
		<user name="workshop17" password="dariah446" authorities="" />
		<user name="workshop18" password="dariah727" authorities="" />
		<user name="workshop19" password="dariah228" authorities="" />
		<user name="workshop20" password="dariah189" authorities="" />
		<user name="workshop21" password="dariah142" authorities="" />
		<user name="workshop22" password="dariah131" authorities="" />
		<user name="workshop23" password="dariah168" authorities="" />
		<user name="workshop24" password="dariah849" authorities="" />
		<user name="workshop25" password="dariah623" authorities="" />
		<user name="workshop26" password="dariah456" authorities="" />
		<user name="workshop27" password="dariah933" authorities="" />
		<user name="workshop28" password="dariah141" authorities="" />
		<user name="workshop29" password="dariah354" authorities="" />
		<user name="workshop30" password="dariah911" authorities="" />
		<user name="workshop31" password="dariah422" authorities="" />
		<user name="workshop32" password="dariah737" authorities="" />
		<user name="workshop33" password="dariah244" authorities="" />
		<user name="workshop34" password="dariah235" authorities="" />
		<user name="workshop35" password="dariah728" authorities="" />
		<user name="workshop36" password="dariah442" authorities="" />
		<user name="workshop37" password="dariah446" authorities="" />
		<user name="workshop38" password="dariah727" authorities="" />
		<user name="workshop39" password="dariah228" authorities="" />
		<user name="workshop40" password="dariah189" authorities="" /> -->
    </user-service>

	
	<beans:bean id="accessDecisionManager" class="org.springframework.security.access.vote.UnanimousBased">
		<beans:constructor-arg name="decisionVoters">
			<beans:list>
				<beans:bean class="org.springframework.security.access.vote.AuthenticatedVoter" />
				<beans:bean class="org.springframework.security.access.vote.RoleVoter" />
			</beans:list>
		</beans:constructor-arg>
		<beans:property name="allowIfAllAbstainDecisions" value="false" />
	</beans:bean>
	
</beans:beans>